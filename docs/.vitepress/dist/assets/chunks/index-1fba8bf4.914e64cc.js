import{cq as N,cu as P,cs as _}from"./index.7434e67a.js";import{m as E}from"./icon.vue_vue_type_script_setup_true_lang-3f9e4127.c7ab9899.js";import{i as S,r as C,w as F,o,c as u,d as s,S as c,a8 as k,e as b,v as I,u as h,a0 as U,C as j,t as A,f as L,m as q,k as O}from"../app.40ba1749.js";const B=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],D=[{label:"change",value:"change"},{label:"blur",value:"blur"}],x=["string","number","url","array","email"],T={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},z={key:0,class:"flex m-t-2 first:m-0"},G={class:"attr-label",title:"\u6821\u9A8C\u65F6\u673A"},H={class:"attr-input"},J=S({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(g,{emit:y}){const m=y,f=g,l=q({get(){return f.rule},set(e){m("update:rule",e)}}),V=O("pageManager",{}),a=q(()=>Object.entries(V.funcs.value).filter(([e,r])=>typeof r=="function").map(([e])=>({label:e,value:e}))),p=[{type:"select",label:"\u6821\u9A8C\u65F6\u673A",model:"trigger",componentProps:{options:D,placeholder:"\u6821\u9A8C\u65F6\u673A",multiple:!0,mode:"multiple"}},{type:"switch",label:"\u81EA\u5B9A\u4E49\u89C4\u5219",model:"isValidator"},{type:"select",label:"\u6821\u9A8C\u51FD\u6570",model:"validator",show(){return!!l.value.isValidator},componentProps:{options:a.value,placeholder:"\u6821\u9A8C\u51FD\u6570"}},{type:"select",label:"\u7C7B\u578B",model:"type",show(){return!l.value.isValidator},componentProps:{options:B,placeholder:"\u7C7B\u578B"}},{type:"input",label:"\u6B63\u5219\u6821\u9A8C",model:"pattern",show(){return!l.value.isValidator},componentProps:{placeholder:"\u6B63\u5219\u6821\u9A8C"}},{type:"number",label:"\u5B57\u6BB5\u957F\u5EA6",model:"len",show(){var e;return x.includes((e=l.value.type)!=null?e:"")},componentProps:{min:0,placeholder:"\u5B57\u6BB5\u957F\u5EA6"}},{type:"number",label:"\u6700\u5C0F\u957F\u5EA6",model:"min",show(){var e;return x.includes((e=l.value.type)!=null?e:"")},componentProps:{min:0,placeholder:"\u6700\u5C0F\u957F\u5EA6"}},{type:"number",label:"\u6700\u5927\u957F\u5EA6",model:"max",show(){var e;return x.includes((e=l.value.type)!=null?e:"")},componentProps:{min:0,placeholder:"\u6700\u5927\u957F\u5EA6"}},{type:"input",label:"\u6821\u9A8C\u4FE1\u606F",model:"message",componentProps:{placeholder:"\u6821\u9A8C\u4FE1\u606F"}}];function w(){const e=l.value;e.isValidator?(delete e.type,delete e.pattern,delete e.len,delete e.min,delete e.max):delete e.validator,m("change",e)}function i(){m("delete")}return(e,r)=>(o(),u("div",T,[(o(),u(c,null,k(p,(t,n)=>(o(),u(c,{key:n},[!t.show||t.show()?(o(),u("div",z,[s("div",G,U(t.label),1),s("div",H,[b(h(_),{modelValue:l.value[t.model],"onUpdate:modelValue":d=>l.value[t.model]=d,componentSchema:{...t,noFormItem:!0},onChange:w},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):j("",!0)],64))),64)),s("div",{class:"rule-btn-delete absolute top-0 right-0 transition-all w-6 h-6 cursor-pointer rounded-bl-1 flex-center color-white",onClick:i},[b(h(E),{name:"icon-shanchu1"})])]))}}),K={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},M={key:0,class:"flex m-t-2 first:m-0"},Q={class:"attr-label"},R={class:"flex-1"},W=S({__name:"index",props:{modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(g,{emit:y}){const m=N.getComponent("button"),f=g,l=C({required:!1,message:"\u5FC5\u586B\u9879",type:"string",trigger:["change"]}),V=[{type:"switch",label:"\u5FC5\u586B\u9879",model:"required"},{type:"select",label:"\u6821\u9A8C\u65F6\u673A",model:"trigger",show(){return!!l.value.required},componentProps:{options:D,placeholder:"\u6821\u9A8C\u65F6\u673A",multiple:!0,mode:"multiple"}},{type:"select",label:"\u7C7B\u578B",model:"type",show(){return!!l.value.required},componentProps:{options:B,placeholder:"\u7C7B\u578B"}},{type:"input",label:"\u6821\u9A8C\u4FE1\u606F",model:"message",show(){return!!l.value.required},componentProps:{placeholder:"\u6821\u9A8C\u4FE1\u606F"}}],a=C([]),p=y;F(()=>f.modelValue,r=>{if(r){if(!r)return;a.value=[],r.forEach(t=>{typeof t.required<"u"?l.value=t:a.value.push(t)})}},{immediate:!0});function w(){a.value.push({message:"",trigger:["change"]}),i()}function i(){if(l.value.required){p("update:modelValue",P([...a.value,l.value]));return}if(a.value.length){p("update:modelValue",P(a.value));return}p("update:modelValue",void 0)}function e(r){a.value.splice(r,1),i()}return(r,t)=>(o(),u("div",null,[s("div",K,[(o(),u(c,null,k(V,(n,d)=>(o(),u(c,{key:d},[!n.show||n.show()?(o(),u("div",M,[s("div",Q,U(n.label),1),s("div",R,[b(h(_),{modelValue:l.value[n.model],"onUpdate:modelValue":v=>l.value[n.model]=v,componentSchema:{...n,noFormItem:!0},onChange:i},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):j("",!0)],64))),64))]),(o(!0),u(c,null,k(a.value,(n,d)=>(o(),A(J,{key:d,rule:a.value[d],"onUpdate:rule":v=>a.value[d]=v,onDelete:v=>e(d),onChange:i},null,8,["rule","onUpdate:rule","onDelete"]))),128)),b(h(m),{class:"m-t-2",onClick:w},{default:I(()=>[L(" \u6DFB\u52A0\u89C4\u5219 ")]),_:1})]))}});export{W as default};
